{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _reactNative = require(\"react-native\");\n\nvar _reactNativeDialog = _interopRequireDefault(require(\"react-native-dialog\"));\n\nvar _reactNativeSimpleDialogs = require(\"react-native-simple-dialogs\");\n\nvar _vectorIcons = require(\"@expo/vector-icons\");\n\nvar _FileItem = _interopRequireDefault(require(\"../components/components/Browser/Files/FileItem\"));\n\nvar _PickImages = _interopRequireDefault(require(\"../components/components/Browser/PickImages\"));\n\nvar _ActionSheet = _interopRequireDefault(require(\"../components/components/ActionSheet\"));\n\nvar _useSelectionChange2 = _interopRequireDefault(require(\"../components/hooks/useSelectionChange\"));\n\nvar _promiseProgress = _interopRequireDefault(require(\"../components/utils/promiseProgress\"));\n\nvar _NewFolderDialog = require(\"../components/components/Browser/NewFolderDialog\");\n\nvar _FileTransferDialog = require(\"../components/components/Browser/FileTransferDialog\");\n\nvar _axios = _interopRequireDefault(require(\"axios\"));\n\nvar _moment = _interopRequireDefault(require(\"moment\"));\n\nvar _expoConstants = _interopRequireDefault(require(\"expo-constants\"));\n\nvar FileSystem = _interopRequireWildcard(require(\"expo-file-system\"));\n\nvar ImagePicker = _interopRequireWildcard(require(\"expo-image-picker\"));\n\nvar DocumentPicker = _interopRequireWildcard(require(\"expo-document-picker\"));\n\nvar MediaLibrary = _interopRequireWildcard(require(\"expo-media-library\"));\n\nvar mime = _interopRequireWildcard(require(\"react-native-mime-types\"));\n\nvar _native = require(\"@react-navigation/native\");\n\nvar _reduxHooks = require(\"../components/hooks/reduxHooks\");\n\nvar _imagesSlice = require(\"../components/files/imagesSlice\");\n\nvar _snackbarSlice = require(\"../components/files/snackbarSlice\");\n\nvar _Constants = require(\"../components/utils/Constants\");\n\nvar _Chatbox = _interopRequireDefault(require(\"./Chatbox\"));\n\nvar _jsxRuntime = require(\"react/jsx-runtime\");\n\nvar _this = this,\n    _jsxFileName = \"/Users/kevin/Desktop/group-1010001/front-mobile-gpe/screens/Browser.tsx\";\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nvar Browser = function Browser(_ref) {\n  var _route$params, _route$params2;\n\n  var route = _ref.route;\n  var dispatch = (0, _reduxHooks.useAppDispatch)();\n  var navigation = (0, _native.useNavigation)();\n\n  var _useAppSelector = (0, _reduxHooks.useAppSelector)(function (state) {\n    return state.theme.theme;\n  }),\n      colors = _useAppSelector.colors;\n\n  var docDir = FileSystem.documentDirectory || '';\n\n  var _useState = (0, _react.useState)((route == null ? void 0 : (_route$params = route.params) == null ? void 0 : _route$params.prevDir) !== undefined ? route == null ? void 0 : (_route$params2 = route.params) == null ? void 0 : _route$params2.prevDir : docDir),\n      _useState2 = (0, _slicedToArray2.default)(_useState, 2),\n      currentDir = _useState2[0],\n      setCurrentDir = _useState2[1];\n\n  var _useState3 = (0, _react.useState)(''),\n      _useState4 = (0, _slicedToArray2.default)(_useState3, 2),\n      moveDir = _useState4[0],\n      setMoveDir = _useState4[1];\n\n  var _useState5 = (0, _react.useState)([]),\n      _useState6 = (0, _slicedToArray2.default)(_useState5, 2),\n      files = _useState6[0],\n      setFiles = _useState6[1];\n\n  var _useState7 = (0, _react.useState)([]),\n      _useState8 = (0, _slicedToArray2.default)(_useState7, 2),\n      selectedFiles = _useState8[0],\n      setSelectedFiles = _useState8[1];\n\n  var _useState9 = (0, _react.useState)(false),\n      _useState10 = (0, _slicedToArray2.default)(_useState9, 2),\n      folderDialogVisible = _useState10[0],\n      setFolderDialogVisible = _useState10[1];\n\n  var _useState11 = (0, _react.useState)(false),\n      _useState12 = (0, _slicedToArray2.default)(_useState11, 2),\n      downloadDialogVisible = _useState12[0],\n      setDownloadDialogVisible = _useState12[1];\n\n  var _useState13 = (0, _react.useState)(false),\n      _useState14 = (0, _slicedToArray2.default)(_useState13, 2),\n      renameDialogVisible = _useState14[0],\n      setRenameDialogVisible = _useState14[1];\n\n  var _useState15 = (0, _react.useState)(''),\n      _useState16 = (0, _slicedToArray2.default)(_useState15, 2),\n      newFileName = _useState16[0],\n      setNewFileName = _useState16[1];\n\n  var _useState17 = (0, _react.useState)(),\n      _useState18 = (0, _slicedToArray2.default)(_useState17, 2),\n      renamingFile = _useState18[0],\n      setRenamingFile = _useState18[1];\n\n  var renameInputRef = (0, _react.useRef)(null);\n\n  var _useState19 = (0, _react.useState)(false),\n      _useState20 = (0, _slicedToArray2.default)(_useState19, 2),\n      multiImageVisible = _useState20[0],\n      setMultiImageVisible = _useState20[1];\n\n  var _useState21 = (0, _react.useState)(false),\n      _useState22 = (0, _slicedToArray2.default)(_useState21, 2),\n      importProgressVisible = _useState22[0],\n      setImportProgressVisible = _useState22[1];\n\n  var _useState23 = (0, _react.useState)(false),\n      _useState24 = (0, _slicedToArray2.default)(_useState23, 2),\n      destinationDialogVisible = _useState24[0],\n      setDestinationDialogVisible = _useState24[1];\n\n  var _useState25 = (0, _react.useState)(false),\n      _useState26 = (0, _slicedToArray2.default)(_useState25, 2),\n      newFileActionSheet = _useState26[0],\n      setNewFileActionSheet = _useState26[1];\n\n  var _useState27 = (0, _react.useState)(''),\n      _useState28 = (0, _slicedToArray2.default)(_useState27, 2),\n      moveOrCopy = _useState28[0],\n      setMoveOrCopy = _useState28[1];\n\n  var _useSelectionChange = (0, _useSelectionChange2.default)(files),\n      multiSelect = _useSelectionChange.multiSelect,\n      allSelected = _useSelectionChange.allSelected;\n\n  (0, _react.useEffect)(function () {\n    getFiles();\n  }, [currentDir]);\n\n  _react.default.useEffect(function () {\n    var unsubscribe = navigation.addListener('focus', function () {\n      getFiles();\n    });\n    return unsubscribe;\n  }, [navigation]);\n\n  (0, _react.useEffect)(function () {\n    var _route$params3;\n\n    if ((route == null ? void 0 : (_route$params3 = route.params) == null ? void 0 : _route$params3.folderName) !== undefined) {\n      setCurrentDir(function (prev) {\n        return prev != null && prev.endsWith('/') ? prev + route.params.folderName : prev + '/' + route.params.folderName;\n      });\n    }\n  }, [route]);\n  (0, _react.useEffect)(function () {\n    var backAction = function backAction() {\n      if (navigation.canGoBack()) navigation.goBack();\n      return true;\n    };\n\n    var backHandler = _reactNative.BackHandler.addEventListener('hardwareBackPress', backAction);\n\n    return function () {\n      return backHandler.remove();\n    };\n  }, []);\n\n  var renderItem = function renderItem(_ref2) {\n    var item = _ref2.item;\n    return (0, _jsxRuntime.jsx)(_reactNative.View, {\n      style: styles.column,\n      children: (0, _jsxRuntime.jsx)(_FileItem.default, {\n        item: item,\n        currentDir: currentDir,\n        toggleSelect: toggleSelect,\n        multiSelect: multiSelect,\n        setTransferDialog: setDestinationDialogVisible,\n        setMoveOrCopy: setMoveOrCopy,\n        deleteSelectedFiles: deleteSelectedFiles,\n        setRenamingFile: setRenamingFile,\n        setRenameDialogVisible: setRenameDialogVisible,\n        setNewFileName: setNewFileName\n      })\n    });\n  };\n\n  var handleDownload = function handleDownload(downloadUrl) {\n    _axios.default.get(downloadUrl).then(function (res) {\n      var fileExt = mime.extension(res.headers['content-type']);\n      FileSystem.downloadAsync(downloadUrl, currentDir + '/DL_' + (0, _moment.default)().format('DDMMYHmmss') + '.' + fileExt).then(function () {\n        getFiles();\n        setDownloadDialogVisible(false);\n        handleSetSnack({\n          message: 'Download complete'\n        });\n      }).catch(function (_) {\n        handleSetSnack({\n          message: 'Please provide a correct url'\n        });\n      });\n    }).catch(function (error) {\n      return handleSetSnack({\n        message: error.message\n      });\n    });\n  };\n\n  var toggleSelect = function toggleSelect(item) {\n    if (item.selected && selectedFiles.includes(item)) {\n      var index = selectedFiles.indexOf(item);\n\n      if (index > -1) {\n        selectedFiles.splice(index, 1);\n      }\n    } else if (!item.selected && !selectedFiles.includes(item)) {\n      setSelectedFiles(function (prev) {\n        return [].concat((0, _toConsumableArray2.default)(prev), [item]);\n      });\n    }\n\n    setFiles(files.map(function (i) {\n      if (item === i) {\n        i.selected = !i.selected;\n      }\n\n      return i;\n    }));\n  };\n\n  var toggleSelectAll = function toggleSelectAll() {\n    if (!allSelected) {\n      setFiles(files.map(function (item) {\n        item.selected = true;\n        return item;\n      }));\n      setSelectedFiles(files);\n    } else {\n      setFiles(files.map(function (item) {\n        item.selected = false;\n        return item;\n      }));\n      setSelectedFiles([]);\n    }\n  };\n\n  var getFiles = function () {\n    var _ref3 = (0, _asyncToGenerator2.default)(function* () {\n      FileSystem.readDirectoryAsync(currentDir + '/folder/').then(function (dirFiles) {\n        var _route$params4;\n\n        if (currentDir !== (route == null ? void 0 : (_route$params4 = route.params) == null ? void 0 : _route$params4.prevDir)) {\n          var filteredFiles = dirFiles.filter(function (file) {\n            return file !== 'RCTAsyncLocalStorage';\n          });\n          var filesProms = filteredFiles.map(function (fileName) {\n            return FileSystem.getInfoAsync(currentDir + '/folder/' + fileName);\n          });\n          Promise.all(filesProms).then(function (results) {\n            var tempfiles = results.map(function (file) {\n              var name = file.uri.endsWith('/') ? file.uri.slice(0, file.uri.length - 1).split('/').pop() : file.uri.split('/').pop();\n              return Object(Object.assign({}, file, {\n                name: name,\n                selected: false\n              }));\n            });\n            setFiles(tempfiles);\n            var tempImageFiles = results.filter(function (file) {\n              var fileExtension = file.uri.split('/').pop().split('.').pop().toLowerCase();\n\n              if (_Constants.imageFormats.includes(fileExtension)) {\n                return file;\n              }\n            });\n            dispatch((0, _imagesSlice.setImages)(tempImageFiles));\n          });\n        }\n      }).catch(function (_) {});\n    });\n\n    return function getFiles() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  function createDirectory(_x) {\n    return _createDirectory.apply(this, arguments);\n  }\n\n  function _createDirectory() {\n    _createDirectory = (0, _asyncToGenerator2.default)(function* (name) {\n      try {\n        yield FileSystem.makeDirectoryAsync(currentDir + '/folder/' + name);\n        getFiles();\n        setFolderDialogVisible(false);\n      } catch (error) {\n        handleSetSnack({\n          message: 'Folder could not be created or already exists.'\n        });\n      }\n    });\n    return _createDirectory.apply(this, arguments);\n  }\n\n  var pickImage = function () {\n    var _ref4 = (0, _asyncToGenerator2.default)(function* () {\n      (0, _asyncToGenerator2.default)(function* () {\n        if (_reactNative.Platform.OS !== 'web') {\n          var _yield$ImagePicker$re = yield ImagePicker.requestMediaLibraryPermissionsAsync(),\n              status = _yield$ImagePicker$re.status;\n\n          if (status !== 'granted') {\n            handleSetSnack({\n              message: 'Sorry, we need camera roll permissions to make this work!'\n            });\n          }\n\n          MediaLibrary.requestPermissionsAsync();\n        }\n      })();\n      var result = yield ImagePicker.launchImageLibraryAsync({\n        mediaTypes: ImagePicker.MediaTypeOptions.All,\n        aspect: [4, 3],\n        quality: 1\n      });\n\n      if (!result.cancelled) {\n        var _ref6 = result,\n            uri = _ref6.uri,\n            type = _ref6.type;\n        var filename = uri.replace(/^.*[\\\\\\/]/, '');\n\n        var ext = _Constants.reExt.exec(filename)[1];\n\n        var fileNamePrefix = type === 'image' ? 'IMG_' : 'VID_';\n        var folderPath = currentDir + '/folder/';\n        var newFilePath = folderPath + (folderPath.endsWith('/folder/') ? '' : '/folder/') + fileNamePrefix + (0, _moment.default)().format('DDMMYHmmss') + '.' + ext;\n\n        try {\n          yield createDirectory('');\n          yield FileSystem.moveAsync({\n            from: uri,\n            to: newFilePath\n          });\n          getFiles();\n        } catch (err) {\n          console.error('Error picking image:', err);\n        }\n      }\n    });\n\n    return function pickImage() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  function handleCopy(_x2, _x3, _x4, _x5) {\n    return _handleCopy.apply(this, arguments);\n  }\n\n  function _handleCopy() {\n    _handleCopy = (0, _asyncToGenerator2.default)(function* (from, to, successMessage, errorMessage) {\n      FileSystem.copyAsync({\n        from: from,\n        to: to\n      }).then(function () {\n        getFiles();\n        handleSetSnack({\n          message: successMessage\n        });\n      }).catch(function () {\n        return handleSetSnack({\n          message: errorMessage\n        });\n      });\n    });\n    return _handleCopy.apply(this, arguments);\n  }\n\n  var pickDocument = function () {\n    var _ref7 = (0, _asyncToGenerator2.default)(function* () {\n      var result = yield DocumentPicker.getDocumentAsync({\n        copyToCacheDirectory: false\n      });\n\n      if (result.type === 'success') {\n        var _yield$FileSystem$get = yield FileSystem.getInfoAsync(currentDir + '/' + result.name),\n            fileExists = _yield$FileSystem$get.exists;\n\n        if (fileExists) {\n          _reactNative.Alert.alert('Conflicting File', \"The destination folder has a file with the same name \" + result.name, [{\n            text: 'Cancel',\n            style: 'cancel'\n          }, {\n            text: 'Replace the file',\n            onPress: function onPress() {\n              handleCopy(result.uri, currentDir + '/' + result.name, result.name + \" successfully copied.\", 'An unexpected error importing the file.');\n            },\n            style: 'default'\n          }]);\n        } else {\n          handleCopy(result.uri, currentDir + '/' + result.name, result.name + \" successfully copied.\", 'An unexpected error importing the file.');\n        }\n      }\n    });\n\n    return function pickDocument() {\n      return _ref7.apply(this, arguments);\n    };\n  }();\n\n  var onMultiSelectSubmit = function () {\n    var _ref8 = (0, _asyncToGenerator2.default)(function* (data) {\n      var transferPromises = data.map(function (file) {\n        return FileSystem.copyAsync({\n          from: file.uri,\n          to: currentDir + '/folder/' + file.filename\n        });\n      });\n      Promise.all(transferPromises).then(function () {\n        setMultiImageVisible(false);\n        getFiles();\n      });\n    });\n\n    return function onMultiSelectSubmit(_x6) {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n\n  var moveSelectedFiles = function () {\n    var _ref9 = (0, _asyncToGenerator2.default)(function* (destination) {\n      var selectedFiles = files.filter(function (file) {\n        return file.selected;\n      });\n      var destinationFolderFiles = yield FileSystem.readDirectoryAsync(destination);\n\n      function executeTransfer() {\n        var transferPromises = selectedFiles.map(function (file) {\n          if (moveOrCopy === 'Copy') return FileSystem.copyAsync({\n            from: currentDir + '/folder/' + file.name,\n            to: destination + '/folder/' + file.name\n          });else return FileSystem.moveAsync({\n            from: currentDir + '/folder/' + file.name,\n            to: destination + '/folder/' + file.name\n          });\n        });\n        (0, _promiseProgress.default)(transferPromises, function (p) {}).then(function (_) {\n          setDestinationDialogVisible(false);\n          setMoveDir('');\n          setMoveOrCopy('');\n          getFiles();\n        });\n      }\n\n      var conflictingFiles = selectedFiles.filter(function (file) {\n        return destinationFolderFiles.includes(file.name);\n      });\n      var confLen = conflictingFiles.length;\n\n      if (confLen > 0) {\n        _reactNative.Alert.alert('Conflicting Files', \"The destination folder has \" + confLen + \" \" + (confLen === 1 ? 'file' : 'files') + \" with the same \" + (confLen === 1 ? 'name' : 'names') + \".\", [{\n          text: 'Cancel',\n          style: 'cancel'\n        }, {\n          text: 'Replace the files',\n          onPress: function onPress() {\n            executeTransfer();\n          },\n          style: 'default'\n        }]);\n      } else {\n        executeTransfer();\n      }\n    });\n\n    return function moveSelectedFiles(_x7) {\n      return _ref9.apply(this, arguments);\n    };\n  }();\n\n  var deleteSelectedFiles = function () {\n    var _ref10 = (0, _asyncToGenerator2.default)(function* (file) {\n      var filestoBeDeleted = file ? [file] : selectedFiles;\n      var deleteProms = filestoBeDeleted.map(function (file) {\n        return FileSystem.deleteAsync(file.uri);\n      });\n      Promise.all(deleteProms).then(function (_) {\n        handleSetSnack({\n          message: 'Files deleted!'\n        });\n        getFiles();\n        setSelectedFiles([]);\n      }).catch(function (err) {\n        console.log(err);\n        getFiles();\n      });\n    });\n\n    return function deleteSelectedFiles(_x8) {\n      return _ref10.apply(this, arguments);\n    };\n  }();\n\n  var _useState29 = (0, _react.useState)(false),\n      _useState30 = (0, _slicedToArray2.default)(_useState29, 2),\n      initialSelectionDone = _useState30[0],\n      setInitialSelectionDone = _useState30[1];\n\n  (0, _react.useEffect)(function () {\n    if (renameDialogVisible && _reactNative.Platform.OS === 'android') {\n      setTimeout(function () {\n        var _renameInputRef$curre;\n\n        (_renameInputRef$curre = renameInputRef.current) == null ? void 0 : _renameInputRef$curre.focus();\n      }, 100);\n    }\n\n    if (!renameDialogVisible) setTimeout(function () {\n      setInitialSelectionDone(false);\n    }, 500);\n  }, [renameDialogVisible]);\n\n  var onRename = function () {\n    var _ref11 = (0, _asyncToGenerator2.default)(function* () {\n      var filePathSplit = renamingFile.uri.split('/folder/');\n      var fileFolderPath = filePathSplit.slice(0, filePathSplit.length - 1).join('/folder/');\n      FileSystem.getInfoAsync(fileFolderPath + '/folder/' + newFileName).then(function (res) {\n        if (res.exists) handleSetSnack({\n          message: 'A folder or file with the same name already exists.'\n        });else FileSystem.moveAsync({\n          from: renamingFile.uri,\n          to: fileFolderPath + '/' + newFileName\n        }).then(function () {\n          setRenameDialogVisible(false);\n          getFiles();\n        }).catch(function (_) {\n          return handleSetSnack({\n            message: 'Error renaming the file/folder/'\n          });\n        });\n      });\n    });\n\n    return function onRename() {\n      return _ref11.apply(this, arguments);\n    };\n  }();\n\n  var handleSetSnack = function handleSetSnack(data) {\n    dispatch((0, _snackbarSlice.setSnack)(data));\n  };\n\n  return (0, _jsxRuntime.jsxs)(_reactNative.View, {\n    style: styles.container,\n    children: [(0, _jsxRuntime.jsx)(_ActionSheet.default, {\n      title: 'Add a new file',\n      numberOfLinesTitle: undefined,\n      visible: newFileActionSheet,\n      actionItems: ['Camera Roll', 'Multi Image Picker', 'Import File from Storage', 'Download', 'Cancel'],\n      itemIcons: ['camera', 'image', 'drive-file-move-outline', 'file-download', 'close'],\n      onClose: setNewFileActionSheet,\n      onItemPressed: function onItemPressed(buttonIndex) {\n        if (buttonIndex === 0) {\n          pickImage();\n        } else if (buttonIndex === 1) {\n          setMultiImageVisible(true);\n        } else if (buttonIndex === 2) {\n          pickDocument();\n        } else if (buttonIndex === 3) {\n          setDownloadDialogVisible(true);\n        }\n      },\n      cancelButtonIndex: 4,\n      modalStyle: {\n        backgroundColor: colors.background2\n      },\n      itemTextStyle: {\n        color: colors.text\n      },\n      titleStyle: {\n        color: colors.secondary\n      }\n    }), (0, _jsxRuntime.jsx)(_FileTransferDialog.FileTransferDialog, {\n      isVisible: destinationDialogVisible,\n      setIsVisible: setDestinationDialogVisible,\n      currentDir: docDir,\n      moveDir: moveDir,\n      setMoveDir: setMoveDir,\n      moveSelectedFiles: moveSelectedFiles,\n      moveOrCopy: moveOrCopy,\n      setMoveOrCopy: setMoveOrCopy\n    }), (0, _jsxRuntime.jsx)(_NewFolderDialog.NewFolderDialog, {\n      visible: folderDialogVisible,\n      createDirectory: createDirectory,\n      setFolderDialogVisible: setFolderDialogVisible\n    }), (0, _jsxRuntime.jsxs)(_reactNativeDialog.default.Container, {\n      visible: renameDialogVisible,\n      children: [(0, _jsxRuntime.jsx)(_reactNativeDialog.default.Title, {\n        style: {\n          color: 'black'\n        },\n        children: \"Rename file\"\n      }), (0, _jsxRuntime.jsx)(_reactNativeDialog.default.Input, {\n        textInputRef: renameInputRef,\n        value: decodeURI(newFileName),\n        onChangeText: function onChangeText(text) {\n          setNewFileName(text);\n        },\n        onKeyPress: function onKeyPress() {\n          setInitialSelectionDone(true);\n        },\n        selection: !initialSelectionDone ? {\n          start: 0,\n          end: decodeURI(newFileName).split('.')[0].length\n        } : undefined,\n        style: {\n          color: 'black'\n        }\n      }), (0, _jsxRuntime.jsx)(_reactNativeDialog.default.Button, {\n        label: \"Cancel\",\n        onPress: function onPress() {\n          setRenameDialogVisible(false);\n        }\n      }), (0, _jsxRuntime.jsx)(_reactNativeDialog.default.Button, {\n        label: \"Rename\",\n        onPress: function onPress() {\n          return onRename();\n        }\n      })]\n    }), (0, _jsxRuntime.jsx)(_reactNativeSimpleDialogs.Dialog, {\n      dialogStyle: {\n        backgroundColor: colors.background2\n      },\n      animationType: \"slide\",\n      contentStyle: styles.contentStyle,\n      overlayStyle: styles.overlayStyle,\n      visible: multiImageVisible,\n      onTouchOutside: function onTouchOutside() {\n        return setMultiImageVisible(false);\n      },\n      children: (0, _jsxRuntime.jsx)(_PickImages.default, {\n        onMultiSelectSubmit: onMultiSelectSubmit,\n        onClose: function onClose() {\n          return setMultiImageVisible(false);\n        }\n      })\n    }), (0, _jsxRuntime.jsx)(_reactNativeSimpleDialogs.ProgressDialog, {\n      visible: importProgressVisible,\n      title: \"Importing Assets\",\n      message: \"Please, wait...\"\n    }), (0, _jsxRuntime.jsxs)(_reactNative.View, {\n      style: styles.topButtons,\n      children: [(0, _jsxRuntime.jsxs)(_reactNative.View, {\n        style: styles.topLeft,\n        children: [(0, _jsxRuntime.jsx)(_reactNative.TouchableOpacity, {\n          onPress: function onPress() {\n            return setNewFileActionSheet(true);\n          },\n          children: (0, _jsxRuntime.jsx)(_vectorIcons.AntDesign, {\n            name: \"addfile\",\n            size: 30,\n            color: colors.primary\n          })\n        }), (0, _jsxRuntime.jsx)(_reactNative.TouchableOpacity, {\n          onPress: function onPress() {\n            return setFolderDialogVisible(true);\n          },\n          children: (0, _jsxRuntime.jsx)(_vectorIcons.Feather, {\n            name: \"folder-plus\",\n            size: 30,\n            color: colors.primary\n          })\n        })]\n      }), multiSelect && (0, _jsxRuntime.jsxs)(_reactNative.View, {\n        style: styles.topRight,\n        children: [(0, _jsxRuntime.jsx)(_reactNative.TouchableOpacity, {\n          onPress: function onPress() {\n            setDestinationDialogVisible(true);\n            setMoveOrCopy('Move');\n          },\n          children: (0, _jsxRuntime.jsx)(_vectorIcons.MaterialCommunityIcons, {\n            name: \"file-move-outline\",\n            size: 30,\n            color: colors.background\n          })\n        }), (0, _jsxRuntime.jsx)(_reactNative.TouchableOpacity, {\n          onPress: toggleSelectAll,\n          children: (0, _jsxRuntime.jsx)(_vectorIcons.Feather, {\n            style: {\n              marginLeft: 10\n            },\n            name: allSelected ? 'check-square' : 'square',\n            size: 24,\n            color: colors.primary\n          })\n        })]\n      })]\n    }), (0, _jsxRuntime.jsx)(_reactNative.View, {\n      style: Object.assign({}, styles.fileList, {\n        borderTopColor: colors.primary\n      }),\n      children: (0, _jsxRuntime.jsx)(_reactNative.FlatList, {\n        data: files,\n        showsVerticalScrollIndicator: false,\n        renderItem: renderItem,\n        keyExtractor: _keyExtractor,\n        numColumns: 3\n      })\n    }), multiSelect && (0, _jsxRuntime.jsx)(_reactNative.View, {\n      style: Object.assign({}, styles.bottomMenu, {\n        backgroundColor: colors.background\n      }),\n      children: (0, _jsxRuntime.jsx)(_reactNative.TouchableOpacity, {\n        children: (0, _jsxRuntime.jsx)(_vectorIcons.MaterialCommunityIcons, {\n          name: \"export-variant\",\n          size: 28,\n          color: colors.primary\n        })\n      })\n    }), (0, _jsxRuntime.jsx)(_Chatbox.default, {})]\n  });\n};\n\nvar _keyExtractor = function _keyExtractor(item) {\n  return item.name;\n};\n\nvar styles = _reactNative.StyleSheet.create({\n  container: {\n    flex: 1,\n    width: _Constants.SIZE,\n    paddingTop: _expoConstants.default.statusBarHeight\n  },\n  topButtons: {\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginTop: 15,\n    marginHorizontal: 10\n  },\n  topLeft: {\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    width: '25%'\n  },\n  topRight: {\n    width: '50%',\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'flex-end',\n    alignItems: 'center'\n  },\n  fileList: {\n    flex: 1,\n    borderTopWidth: 0.5,\n    marginTop: 15,\n    marginHorizontal: 5\n  },\n  bottomMenu: {\n    height: 45,\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'space-evenly',\n    alignItems: 'center'\n  },\n  contentStyle: {\n    width: _Constants.SIZE,\n    height: _Constants.HEIGHT * 0.8,\n    padding: 0,\n    margin: 0\n  },\n  overlayStyle: {\n    width: _Constants.SIZE,\n    padding: 0,\n    margin: 0\n  },\n  column: {\n    flex: 1,\n    flexDirection: 'column',\n    margin: 5\n  }\n});\n\nvar _default = Browser;\nexports.default = _default;","map":{"version":3,"names":["Browser","route","dispatch","useAppDispatch","navigation","useNavigation","useAppSelector","state","theme","colors","docDir","FileSystem","documentDirectory","useState","params","prevDir","undefined","currentDir","setCurrentDir","moveDir","setMoveDir","files","setFiles","selectedFiles","setSelectedFiles","folderDialogVisible","setFolderDialogVisible","downloadDialogVisible","setDownloadDialogVisible","renameDialogVisible","setRenameDialogVisible","newFileName","setNewFileName","renamingFile","setRenamingFile","renameInputRef","useRef","multiImageVisible","setMultiImageVisible","importProgressVisible","setImportProgressVisible","destinationDialogVisible","setDestinationDialogVisible","newFileActionSheet","setNewFileActionSheet","moveOrCopy","setMoveOrCopy","useSelectionChange","multiSelect","allSelected","useEffect","getFiles","React","unsubscribe","addListener","folderName","prev","endsWith","backAction","canGoBack","goBack","backHandler","BackHandler","addEventListener","remove","renderItem","item","styles","column","toggleSelect","deleteSelectedFiles","handleDownload","downloadUrl","axios","get","then","res","fileExt","mime","extension","headers","downloadAsync","moment","format","handleSetSnack","message","catch","_","error","selected","includes","index","indexOf","splice","map","i","toggleSelectAll","readDirectoryAsync","dirFiles","filteredFiles","filter","file","filesProms","fileName","getInfoAsync","Promise","all","results","tempfiles","name","uri","slice","length","split","pop","Object","tempImageFiles","fileExtension","toLowerCase","imageFormats","setImages","createDirectory","makeDirectoryAsync","pickImage","Platform","OS","ImagePicker","requestMediaLibraryPermissionsAsync","status","MediaLibrary","requestPermissionsAsync","result","launchImageLibraryAsync","mediaTypes","MediaTypeOptions","All","aspect","quality","cancelled","type","filename","replace","ext","reExt","exec","fileNamePrefix","folderPath","newFilePath","moveAsync","from","to","err","console","handleCopy","successMessage","errorMessage","copyAsync","pickDocument","DocumentPicker","getDocumentAsync","copyToCacheDirectory","fileExists","exists","Alert","alert","text","style","onPress","onMultiSelectSubmit","data","transferPromises","moveSelectedFiles","destination","destinationFolderFiles","executeTransfer","allProgress","p","conflictingFiles","confLen","filestoBeDeleted","deleteProms","deleteAsync","log","initialSelectionDone","setInitialSelectionDone","setTimeout","current","focus","onRename","filePathSplit","fileFolderPath","join","setSnack","container","buttonIndex","backgroundColor","background2","color","secondary","decodeURI","start","end","contentStyle","overlayStyle","topButtons","topLeft","primary","topRight","background","marginLeft","fileList","borderTopColor","_keyExtractor","bottomMenu","StyleSheet","create","flex","width","SIZE","paddingTop","Constants","statusBarHeight","display","flexDirection","justifyContent","alignItems","marginTop","marginHorizontal","borderTopWidth","height","HEIGHT","padding","margin"],"sources":["/Users/kevin/Desktop/group-1010001/front-mobile-gpe/screens/Browser.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport {\n  View,\n  StyleSheet,\n  FlatList,\n  TouchableOpacity,\n  Platform,\n  Alert,\n  BackHandler,\n  TextInput,\n} from 'react-native';\n\nimport Dialog from 'react-native-dialog';\n\nimport {\n  Dialog as GalleryDialog,\n  ProgressDialog,\n} from 'react-native-simple-dialogs';\nimport { AntDesign, Feather } from '@expo/vector-icons';\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\n\nimport FileItem from '../components/components/Browser/Files/FileItem';\nimport Pickimages from '../components/components/Browser/PickImages';\nimport ActionSheet from '../components/components/ActionSheet';\n\nimport useSelectionChange from '../components/hooks/useSelectionChange';\nimport allProgress from '../components/utils/promiseProgress';\n\nimport { NewFolderDialog } from '../components/components/Browser/NewFolderDialog';\nimport { DownloadDialog } from '../components/components/Browser/DownloadDialog';\nimport { FileTransferDialog } from '../components/components/Browser/FileTransferDialog';\n\nimport axios, { AxiosError } from 'axios';\nimport moment from 'moment';\nimport Constants from 'expo-constants';\nimport * as FileSystem from 'expo-file-system';\nimport * as ImagePicker from 'expo-image-picker';\nimport * as DocumentPicker from 'expo-document-picker';\nimport * as MediaLibrary from 'expo-media-library';\nimport * as mime from 'react-native-mime-types';\n\nimport { StackScreenProps } from '@react-navigation/stack';\nimport { useNavigation } from '@react-navigation/native';\nimport { ImageInfo } from 'expo-image-picker/build/ImagePicker.types';\nimport { ExtendedAsset, fileItem } from '../components/utils/types';\nimport { useAppDispatch, useAppSelector } from '../components/hooks/reduxHooks';\nimport { setImages } from '../components/files/imagesSlice';\nimport { setSnack, snackActionPayload } from '../components/files/snackbarSlice';\nimport { HEIGHT, imageFormats, reExt, SIZE } from '../components/utils/Constants';\nimport ChatBox from './Chatbox';\nimport Background from '../components/Background';\n\ntype BrowserParamList = {\n  Browser: { prevDir: string; folderName: string };\n};\n\ntype IBrowserProps = StackScreenProps<BrowserParamList, 'Browser'>;\n\nconst Browser = ({ route }: IBrowserProps) => {\n  const dispatch = useAppDispatch();\n  const navigation = useNavigation();\n  const { colors } = useAppSelector((state) => state.theme.theme);\n  const docDir: string = FileSystem.documentDirectory || '';\n  const [currentDir, setCurrentDir] = useState<string>(\n    route?.params?.prevDir !== undefined ? route?.params?.prevDir : docDir\n  );\n  const [moveDir, setMoveDir] = useState('');\n  const [files, setFiles] = useState<fileItem[]>([]);\n  const [selectedFiles, setSelectedFiles] = useState<fileItem[]>([]);\n  const [folderDialogVisible, setFolderDialogVisible] = useState(false);\n  const [downloadDialogVisible, setDownloadDialogVisible] = useState(false);\n  const [renameDialogVisible, setRenameDialogVisible] = useState(false);\n  const [newFileName, setNewFileName] = useState('');\n  const [renamingFile, setRenamingFile] = useState<fileItem>();\n  const renameInputRef = useRef<TextInput>(null);\n  const [multiImageVisible, setMultiImageVisible] = useState(false);\n  const [importProgressVisible, setImportProgressVisible] = useState(false);\n  const [destinationDialogVisible, setDestinationDialogVisible] =\n    useState(false);\n  const [newFileActionSheet, setNewFileActionSheet] = useState(false);\n  const [moveOrCopy, setMoveOrCopy] = useState('');\n  const { multiSelect, allSelected } = useSelectionChange(files);\n\n\n  useEffect(() => {\n    getFiles();\n  }, [currentDir]);\n\n  React.useEffect(() => {\n    const unsubscribe = navigation.addListener('focus', () => {\n      getFiles();\n    });\n\n    return unsubscribe;\n  }, [navigation]);\n\n  useEffect(() => {\n    if (route?.params?.folderName !== undefined) {\n      setCurrentDir((prev) =>\n        prev?.endsWith('/')\n          ? prev + route.params.folderName\n          : prev + '/' + route.params.folderName\n      );\n    }\n  }, [route]);\n\n  useEffect(() => {\n    const backAction = () => {\n      if (navigation.canGoBack()) navigation.goBack();\n      return true;\n    };\n\n    const backHandler = BackHandler.addEventListener(\n      'hardwareBackPress',\n      backAction\n    );\n\n    return () => backHandler.remove();\n  }, []);\n\n  const renderItem = ({ item }: { item: fileItem }) => (\n    <View style={styles.column}>\n      <FileItem\n        item={item}\n        currentDir={currentDir}\n        toggleSelect={toggleSelect}\n        multiSelect={multiSelect}\n        setTransferDialog={setDestinationDialogVisible}\n        setMoveOrCopy={setMoveOrCopy}\n        deleteSelectedFiles={deleteSelectedFiles}\n        setRenamingFile={setRenamingFile}\n        setRenameDialogVisible={setRenameDialogVisible}\n        setNewFileName={setNewFileName}\n      />\n    </View>\n  );\n\n  const handleDownload = (downloadUrl: string) => {\n    axios\n      .get(downloadUrl)\n      .then((res) => {\n        const fileExt = mime.extension(res.headers['content-type']);\n        FileSystem.downloadAsync(\n          downloadUrl,\n          currentDir + '/DL_' + moment().format('DDMMYHmmss') + '.' + fileExt\n        )\n          .then(() => {\n            getFiles();\n            setDownloadDialogVisible(false);\n            handleSetSnack({\n              message: 'Download complete',\n            });\n          })\n          .catch((_) => {\n            handleSetSnack({\n              message: 'Please provide a correct url',\n            });\n          });\n      })\n      .catch((error: AxiosError) =>\n        handleSetSnack({\n          message: error.message,\n        })\n      );\n  };\n\n  const toggleSelect = (item: fileItem) => {\n    if (item.selected && selectedFiles.includes(item)) {\n      const index = selectedFiles.indexOf(item);\n      if (index > -1) {\n        selectedFiles.splice(index, 1);\n      }\n    } else if (!item.selected && !selectedFiles.includes(item)) {\n      setSelectedFiles((prev) => [...prev, item]);\n    }\n    setFiles(\n      files.map((i) => {\n        if (item === i) {\n          i.selected = !i.selected;\n        }\n        return i;\n      })\n    );\n  };\n\n  const toggleSelectAll = () => {\n    if (!allSelected) {\n      setFiles(\n        files.map((item) => {\n          item.selected = true;\n          return item;\n        })\n      );\n      setSelectedFiles(files);\n    } else {\n      setFiles(\n        files.map((item) => {\n          item.selected = false;\n          return item;\n        })\n      );\n      setSelectedFiles([]);\n    }\n  };\n\n  const getFiles = async () => {\n    FileSystem.readDirectoryAsync(currentDir + '/folder/')\n      .then((dirFiles) => {\n        if (currentDir !== route?.params?.prevDir) {\n          const filteredFiles = dirFiles.filter(\n            (file) => file !== 'RCTAsyncLocalStorage'\n          );\n          const filesProms = filteredFiles.map((fileName) =>\n            FileSystem.getInfoAsync(currentDir + '/folder/' + fileName)\n          );\n          Promise.all(filesProms).then((results) => {\n            let tempfiles: fileItem[] = results.map((file) => {\n              const name = file.uri.endsWith('/')\n                ? file.uri\n                    .slice(0, file.uri.length - 1)\n                    .split('/')\n                    .pop()\n                : file.uri.split('/').pop();\n              return Object({\n                ...file,\n                name,\n                selected: false,\n              });\n            });\n            setFiles(tempfiles);\n            const tempImageFiles = results.filter((file) => {\n              let fileExtension = file.uri\n                .split('/')\n                .pop()\n                .split('.')\n                .pop()\n                .toLowerCase();\n              if (imageFormats.includes(fileExtension)) {\n                return file;\n              }\n            });\n            dispatch(setImages(tempImageFiles));\n          });\n        }\n      })\n      .catch((_) => {});\n  };\n\n  async function createDirectory(name: string) {\n    try {\n      await FileSystem.makeDirectoryAsync(currentDir + '/folder/' + name);\n      getFiles();\n      setFolderDialogVisible(false);\n    } catch (error) {\n      handleSetSnack({\n        message: 'Folder could not be created or already exists.',\n      });\n    }\n  }\n\n  const pickImage = async () => {\n    (async () => {\n      if (Platform.OS !== 'web') {\n        const { status } =\n          await ImagePicker.requestMediaLibraryPermissionsAsync();\n        if (status !== 'granted') {\n          handleSetSnack({\n            message:\n              'Sorry, we need camera roll permissions to make this work!',\n          });\n        }\n        MediaLibrary.requestPermissionsAsync();\n      }\n    })();\n  \n    const result = await ImagePicker.launchImageLibraryAsync({\n      mediaTypes: ImagePicker.MediaTypeOptions.All,\n      aspect: [4, 3],\n      quality: 1,\n    });\n  \n    if (!result.cancelled) {\n      const { uri, type } = result as ImageInfo;\n      const filename: string = uri.replace(/^.*[\\\\\\/]/, '');\n      const ext: string | null = reExt.exec(filename)![1];\n      const fileNamePrefix = type === 'image' ? 'IMG_' : 'VID_';\n  \n      const folderPath = currentDir + '/folder/';\n      const newFilePath =\n        folderPath +\n        (folderPath.endsWith('/folder/') ? '' : '/folder/') +\n        fileNamePrefix +\n        moment().format('DDMMYHmmss') +\n        '.' +\n        ext;\n  \n      try {\n        await createDirectory(''); // Ensure the folder exists before moving the file\n        await FileSystem.moveAsync({\n          from: uri,\n          to: newFilePath,\n        });\n        getFiles();\n      } catch (err) {\n        console.error('Error picking image:', err);\n      }\n    }\n  };\n  \n\n  async function handleCopy(\n    from: string,\n    to: string,\n    successMessage: string,\n    errorMessage: string\n  ): Promise<void> {\n    FileSystem.copyAsync({ from, to })\n      .then(() => {\n        getFiles();\n        handleSetSnack({\n          message: successMessage,\n        });\n      })\n      .catch(() =>\n        handleSetSnack({\n          message: errorMessage,\n        })\n      );\n  }\n\n  const pickDocument = async () => {\n    const result = await DocumentPicker.getDocumentAsync({\n      copyToCacheDirectory: false,\n    });\n\n    if (result.type === 'success') {\n      const { exists: fileExists } = await FileSystem.getInfoAsync(\n        currentDir + '/' + result.name\n      );\n      if (fileExists) {\n        Alert.alert(\n          'Conflicting File',\n          `The destination folder has a file with the same name ${result.name}`,\n          [\n            {\n              text: 'Cancel',\n              style: 'cancel',\n            },\n            {\n              text: 'Replace the file',\n              onPress: () => {\n                handleCopy(\n                  result.uri,\n                  currentDir + '/' + result.name,\n                  `${result.name} successfully copied.`,\n                  'An unexpected error importing the file.'\n                );\n              },\n              style: 'default',\n            },\n          ]\n        );\n      } else {\n        handleCopy(\n          result.uri,\n          currentDir + '/' + result.name,\n          `${result.name} successfully copied.`,\n          'An unexpected error importing the file.'\n        );\n      }\n    }\n  };\n\n  const onMultiSelectSubmit = async (data: ExtendedAsset[]) => {\n    const transferPromises = data.map((file) =>\n      FileSystem.copyAsync({\n        from: file.uri,\n        to: currentDir + '/folder/' + file.filename,\n      })\n    );\n    Promise.all(transferPromises).then(() => {\n      setMultiImageVisible(false);\n      getFiles();\n    });\n  };\n\n  const moveSelectedFiles = async (destination: string) => {\n    const selectedFiles = files.filter((file) => file.selected);\n    const destinationFolderFiles = await FileSystem.readDirectoryAsync(\n      destination\n    );\n    function executeTransfer() {\n      const transferPromises = selectedFiles.map((file) => {\n        if (moveOrCopy === 'Copy')\n          return FileSystem.copyAsync({\n            from: currentDir + '/folder/' + file.name,\n            to: destination + '/folder/' + file.name,\n          });\n        else\n          return FileSystem.moveAsync({\n            from: currentDir + '/folder/' + file.name,\n            to: destination + '/folder/' + file.name,\n          });\n      });\n      allProgress(transferPromises, (p) => {}).then((_) => {\n        setDestinationDialogVisible(false);\n        setMoveDir('');\n        setMoveOrCopy('');\n        getFiles();\n      });\n    }\n    const conflictingFiles = selectedFiles.filter((file) =>\n      destinationFolderFiles.includes(file.name)\n    );\n    const confLen = conflictingFiles.length;\n    if (confLen > 0) {\n      Alert.alert(\n        'Conflicting Files',\n        `The destination folder has ${confLen} ${\n          confLen === 1 ? 'file' : 'files'\n        } with the same ${confLen === 1 ? 'name' : 'names'}.`,\n        [\n          {\n            text: 'Cancel',\n            style: 'cancel',\n          },\n          {\n            text: 'Replace the files',\n            onPress: () => {\n              executeTransfer();\n            },\n            style: 'default',\n          },\n        ]\n      );\n    } else {\n      executeTransfer();\n    }\n  };\n\n  const deleteSelectedFiles = async (file?: fileItem) => {\n    const filestoBeDeleted = file ? [file] : selectedFiles;\n    const deleteProms = filestoBeDeleted.map((file) =>\n      FileSystem.deleteAsync(file.uri)\n    );\n    Promise.all(deleteProms)\n      .then((_) => {\n        handleSetSnack({\n          message: 'Files deleted!',\n        });\n        getFiles();\n        setSelectedFiles([]);\n      })\n      .catch((err) => {\n        console.log(err);\n        getFiles();\n      });\n  };\n\n  const [initialSelectionDone, setInitialSelectionDone] = useState(false);\n\n  useEffect(() => {\n    if (renameDialogVisible && Platform.OS === 'android') {\n      setTimeout(() => {\n        renameInputRef.current?.focus();\n      }, 100);\n    }\n    if (!renameDialogVisible)\n      setTimeout(() => {\n        setInitialSelectionDone(false);\n      }, 500);\n  }, [renameDialogVisible]);\n\n  const onRename = async () => {\n    const filePathSplit = renamingFile.uri.split('/folder/');\n    const fileFolderPath = filePathSplit\n      .slice(0, filePathSplit.length - 1)\n      .join('/folder/');\n    FileSystem.getInfoAsync(fileFolderPath + '/folder/' + newFileName).then((res) => {\n      if (res.exists)\n        handleSetSnack({\n          message: 'A folder or file with the same name already exists.',\n        });\n      else\n        FileSystem.moveAsync({\n          from: renamingFile.uri,\n          to: fileFolderPath + '/' + newFileName,\n        })\n          .then(() => {\n            setRenameDialogVisible(false);\n            getFiles();\n          })\n          .catch((_) =>\n            handleSetSnack({\n              message: 'Error renaming the file/folder/',\n            })\n          );\n    });\n  };\n\n  const handleSetSnack = (data: snackActionPayload) => {\n    dispatch(setSnack(data));\n  };\n\n  return (\n    <View style={styles.container}>\n      <ActionSheet\n        title={'Add a new file'}\n        numberOfLinesTitle={undefined}\n        visible={newFileActionSheet}\n        actionItems={[\n          'Camera Roll',\n          'Multi Image Picker',\n          'Import File from Storage',\n          'Download',\n          'Cancel',\n        ]}\n        itemIcons={[\n          'camera',\n          'image',\n          'drive-file-move-outline',\n          'file-download',\n          'close',\n        ]}\n        onClose={setNewFileActionSheet}\n        onItemPressed={(buttonIndex) => {\n          if (buttonIndex === 0) {\n            pickImage();\n          } else if (buttonIndex === 1) {\n            setMultiImageVisible(true);\n          } else if (buttonIndex === 2) {\n            pickDocument();\n          } else if (buttonIndex === 3) {\n            setDownloadDialogVisible(true);\n          }\n        }}\n        cancelButtonIndex={4}\n        modalStyle={{ backgroundColor: colors.background2 }}\n        itemTextStyle={{ color: colors.text }}\n        titleStyle={{ color: colors.secondary }}\n      />\n      <FileTransferDialog\n        isVisible={destinationDialogVisible}\n        setIsVisible={setDestinationDialogVisible}\n        currentDir={docDir}\n        moveDir={moveDir}\n        setMoveDir={setMoveDir}\n        moveSelectedFiles={moveSelectedFiles}\n        moveOrCopy={moveOrCopy}\n        setMoveOrCopy={setMoveOrCopy}\n      />\n      <NewFolderDialog\n        visible={folderDialogVisible}\n        createDirectory={createDirectory}\n        setFolderDialogVisible={setFolderDialogVisible}\n      />\n      <Dialog.Container visible={renameDialogVisible}>\n        <Dialog.Title style={{ color: 'black' }}>Rename file</Dialog.Title>\n        <Dialog.Input\n          textInputRef={renameInputRef}\n          value={decodeURI(newFileName)}\n          onChangeText={(text) => {\n            setNewFileName(text);\n          }}\n          onKeyPress={() => {\n            setInitialSelectionDone(true);\n          }}\n          selection={\n            !initialSelectionDone\n              ? { start: 0, end: decodeURI(newFileName).split('.')[0].length }\n              : undefined\n          }\n          style={{ color: 'black' }}\n        ></Dialog.Input>\n        <Dialog.Button\n          label=\"Cancel\"\n          onPress={() => {\n            setRenameDialogVisible(false);\n          }}\n        />\n        <Dialog.Button label=\"Rename\" onPress={() => onRename()} />\n      </Dialog.Container>\n      <GalleryDialog\n        dialogStyle={{\n          backgroundColor: colors.background2,\n        }}\n        animationType=\"slide\"\n        contentStyle={styles.contentStyle}\n        overlayStyle={styles.overlayStyle}\n        visible={multiImageVisible}\n        onTouchOutside={() => setMultiImageVisible(false)}\n      >\n        <Pickimages\n          onMultiSelectSubmit={onMultiSelectSubmit}\n          onClose={() => setMultiImageVisible(false)}\n        />\n      </GalleryDialog>\n\n      <ProgressDialog\n        visible={importProgressVisible}\n        title=\"Importing Assets\"\n        message=\"Please, wait...\"\n      />\n\n      <View style={styles.topButtons} >\n        <View style={styles.topLeft}>\n          <TouchableOpacity onPress={() => setNewFileActionSheet(true)}>\n            <AntDesign name=\"addfile\" size={30} color={colors.primary} />\n          </TouchableOpacity>\n          <TouchableOpacity onPress={() => setFolderDialogVisible(true)}>\n            <Feather name=\"folder-plus\" size={30} color={colors.primary} />\n          </TouchableOpacity>\n        </View>\n        {multiSelect && (\n          <View style={styles.topRight}>\n            <TouchableOpacity\n              onPress={() => {\n                setDestinationDialogVisible(true);\n                setMoveOrCopy('Move');\n              }}\n            >\n              <MaterialCommunityIcons\n                name=\"file-move-outline\"\n                size={30}\n                color={colors.background}\n              />\n            </TouchableOpacity>\n\n            <TouchableOpacity onPress={toggleSelectAll}>\n              <Feather\n                style={{ marginLeft: 10 }}\n                name={allSelected ? 'check-square' : 'square'}\n                size={24}\n                color={colors.primary}\n              />\n            </TouchableOpacity>\n          </View>\n        )}\n      </View>\n      <View style={{ ...styles.fileList, borderTopColor: colors.primary }}>\n      <FlatList\n        data={files}\n        showsVerticalScrollIndicator={false}\n        renderItem={renderItem}\n        keyExtractor={_keyExtractor}\n        numColumns={3}  // Ajoutez cette ligne pour spcifier le nombre de colonnes\n      />\n      </View>\n      {multiSelect && (\n        <View\n          style={{ ...styles.bottomMenu, backgroundColor: colors.background }}\n        >\n          <TouchableOpacity>\n            <MaterialCommunityIcons\n              name=\"export-variant\"\n              size={28}\n              color={colors.primary}\n            />\n          </TouchableOpacity>\n        </View>\n      )}\n      <ChatBox />\n    </View>\n  );\n};\n\nconst _keyExtractor = (item: fileItem) => item.name;\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    width: SIZE,\n    paddingTop: Constants.statusBarHeight,\n  },\n  topButtons: {\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginTop: 15,\n    marginHorizontal: 10,\n  },\n  topLeft: {\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    width: '25%',\n  },\n  topRight: {\n    width: '50%',\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'flex-end',\n    alignItems: 'center',\n  },\n  fileList: {\n    flex: 1,\n    borderTopWidth: 0.5,\n    marginTop: 15,\n    marginHorizontal: 5,\n  },\n  bottomMenu: {\n    height: 45,\n    display: 'flex',\n    flexDirection: 'row',\n    justifyContent: 'space-evenly',\n    alignItems: 'center',\n  },\n  contentStyle: {\n    width: SIZE,\n    height: HEIGHT * 0.8,\n    padding: 0,\n    margin: 0,\n  },\n  overlayStyle: {\n    width: SIZE,\n    padding: 0,\n    margin: 0,\n  },\n  column: {\n    flex: 1,\n    flexDirection: 'column',\n    margin: 5,\n  },\n});\n\nexport default Browser;\n\n\n\n\n\n\n\n\n"],"mappings":";;;;;;;;;;;;;AAAA;;AACA;;AAWA;;AAEA;;AAIA;;AAGA;;AACA;;AACA;;AAEA;;AACA;;AAEA;;AAEA;;AAEA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAGA;;AAGA;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;;AASA,IAAMA,OAAO,GAAG,SAAVA,OAAU,OAA8B;EAAA;;EAAA,IAA3BC,KAA2B,QAA3BA,KAA2B;EAC5C,IAAMC,QAAQ,GAAG,IAAAC,0BAAA,GAAjB;EACA,IAAMC,UAAU,GAAG,IAAAC,qBAAA,GAAnB;;EACA,sBAAmB,IAAAC,0BAAA,EAAe,UAACC,KAAD;IAAA,OAAWA,KAAK,CAACC,KAAN,CAAYA,KAAvB;EAAA,CAAf,CAAnB;EAAA,IAAQC,MAAR,mBAAQA,MAAR;;EACA,IAAMC,MAAc,GAAGC,UAAU,CAACC,iBAAX,IAAgC,EAAvD;;EACA,gBAAoC,IAAAC,eAAA,EAClC,CAAAZ,KAAK,QAAL,6BAAAA,KAAK,CAAEa,MAAP,mCAAeC,OAAf,MAA2BC,SAA3B,GAAuCf,KAAvC,sCAAuCA,KAAK,CAAEa,MAA9C,qBAAuC,eAAeC,OAAtD,GAAgEL,MAD9B,CAApC;EAAA;EAAA,IAAOO,UAAP;EAAA,IAAmBC,aAAnB;;EAGA,iBAA8B,IAAAL,eAAA,EAAS,EAAT,CAA9B;EAAA;EAAA,IAAOM,OAAP;EAAA,IAAgBC,UAAhB;;EACA,iBAA0B,IAAAP,eAAA,EAAqB,EAArB,CAA1B;EAAA;EAAA,IAAOQ,KAAP;EAAA,IAAcC,QAAd;;EACA,iBAA0C,IAAAT,eAAA,EAAqB,EAArB,CAA1C;EAAA;EAAA,IAAOU,aAAP;EAAA,IAAsBC,gBAAtB;;EACA,iBAAsD,IAAAX,eAAA,EAAS,KAAT,CAAtD;EAAA;EAAA,IAAOY,mBAAP;EAAA,IAA4BC,sBAA5B;;EACA,kBAA0D,IAAAb,eAAA,EAAS,KAAT,CAA1D;EAAA;EAAA,IAAOc,qBAAP;EAAA,IAA8BC,wBAA9B;;EACA,kBAAsD,IAAAf,eAAA,EAAS,KAAT,CAAtD;EAAA;EAAA,IAAOgB,mBAAP;EAAA,IAA4BC,sBAA5B;;EACA,kBAAsC,IAAAjB,eAAA,EAAS,EAAT,CAAtC;EAAA;EAAA,IAAOkB,WAAP;EAAA,IAAoBC,cAApB;;EACA,kBAAwC,IAAAnB,eAAA,GAAxC;EAAA;EAAA,IAAOoB,YAAP;EAAA,IAAqBC,eAArB;;EACA,IAAMC,cAAc,GAAG,IAAAC,aAAA,EAAkB,IAAlB,CAAvB;;EACA,kBAAkD,IAAAvB,eAAA,EAAS,KAAT,CAAlD;EAAA;EAAA,IAAOwB,iBAAP;EAAA,IAA0BC,oBAA1B;;EACA,kBAA0D,IAAAzB,eAAA,EAAS,KAAT,CAA1D;EAAA;EAAA,IAAO0B,qBAAP;EAAA,IAA8BC,wBAA9B;;EACA,kBACE,IAAA3B,eAAA,EAAS,KAAT,CADF;EAAA;EAAA,IAAO4B,wBAAP;EAAA,IAAiCC,2BAAjC;;EAEA,kBAAoD,IAAA7B,eAAA,EAAS,KAAT,CAApD;EAAA;EAAA,IAAO8B,kBAAP;EAAA,IAA2BC,qBAA3B;;EACA,kBAAoC,IAAA/B,eAAA,EAAS,EAAT,CAApC;EAAA;EAAA,IAAOgC,UAAP;EAAA,IAAmBC,aAAnB;;EACA,0BAAqC,IAAAC,4BAAA,EAAmB1B,KAAnB,CAArC;EAAA,IAAQ2B,WAAR,uBAAQA,WAAR;EAAA,IAAqBC,WAArB,uBAAqBA,WAArB;;EAGA,IAAAC,gBAAA,EAAU,YAAM;IACdC,QAAQ;EACT,CAFD,EAEG,CAAClC,UAAD,CAFH;;EAIAmC,cAAA,CAAMF,SAAN,CAAgB,YAAM;IACpB,IAAMG,WAAW,GAAGjD,UAAU,CAACkD,WAAX,CAAuB,OAAvB,EAAgC,YAAM;MACxDH,QAAQ;IACT,CAFmB,CAApB;IAIA,OAAOE,WAAP;EACD,CAND,EAMG,CAACjD,UAAD,CANH;;EAQA,IAAA8C,gBAAA,EAAU,YAAM;IAAA;;IACd,IAAI,CAAAjD,KAAK,QAAL,8BAAAA,KAAK,CAAEa,MAAP,oCAAeyC,UAAf,MAA8BvC,SAAlC,EAA6C;MAC3CE,aAAa,CAAC,UAACsC,IAAD;QAAA,OACZA,IAAI,QAAJ,IAAAA,IAAI,CAAEC,QAAN,CAAe,GAAf,IACID,IAAI,GAAGvD,KAAK,CAACa,MAAN,CAAayC,UADxB,GAEIC,IAAI,GAAG,GAAP,GAAavD,KAAK,CAACa,MAAN,CAAayC,UAHlB;MAAA,CAAD,CAAb;IAKD;EACF,CARD,EAQG,CAACtD,KAAD,CARH;EAUA,IAAAiD,gBAAA,EAAU,YAAM;IACd,IAAMQ,UAAU,GAAG,SAAbA,UAAa,GAAM;MACvB,IAAItD,UAAU,CAACuD,SAAX,EAAJ,EAA4BvD,UAAU,CAACwD,MAAX;MAC5B,OAAO,IAAP;IACD,CAHD;;IAKA,IAAMC,WAAW,GAAGC,wBAAA,CAAYC,gBAAZ,CAClB,mBADkB,EAElBL,UAFkB,CAApB;;IAKA,OAAO;MAAA,OAAMG,WAAW,CAACG,MAAZ,EAAN;IAAA,CAAP;EACD,CAZD,EAYG,EAZH;;EAcA,IAAMC,UAAU,GAAG,SAAbA,UAAa;IAAA,IAAGC,IAAH,SAAGA,IAAH;IAAA,OACjB,qBAAC,iBAAD;MAAM,KAAK,EAAEC,MAAM,CAACC,MAApB;MAAA,UACE,qBAAC,iBAAD;QACE,IAAI,EAAEF,IADR;QAEE,UAAU,EAAEjD,UAFd;QAGE,YAAY,EAAEoD,YAHhB;QAIE,WAAW,EAAErB,WAJf;QAKE,iBAAiB,EAAEN,2BALrB;QAME,aAAa,EAAEI,aANjB;QAOE,mBAAmB,EAAEwB,mBAPvB;QAQE,eAAe,EAAEpC,eARnB;QASE,sBAAsB,EAAEJ,sBAT1B;QAUE,cAAc,EAAEE;MAVlB;IADF,EADiB;EAAA,CAAnB;;EAiBA,IAAMuC,cAAc,GAAG,SAAjBA,cAAiB,CAACC,WAAD,EAAyB;IAC9CC,cAAA,CACGC,GADH,CACOF,WADP,EAEGG,IAFH,CAEQ,UAACC,GAAD,EAAS;MACb,IAAMC,OAAO,GAAGC,IAAI,CAACC,SAAL,CAAeH,GAAG,CAACI,OAAJ,CAAY,cAAZ,CAAf,CAAhB;MACArE,UAAU,CAACsE,aAAX,CACET,WADF,EAEEvD,UAAU,GAAG,MAAb,GAAsB,IAAAiE,eAAA,IAASC,MAAT,CAAgB,YAAhB,CAAtB,GAAsD,GAAtD,GAA4DN,OAF9D,EAIGF,IAJH,CAIQ,YAAM;QACVxB,QAAQ;QACRvB,wBAAwB,CAAC,KAAD,CAAxB;QACAwD,cAAc,CAAC;UACbC,OAAO,EAAE;QADI,CAAD,CAAd;MAGD,CAVH,EAWGC,KAXH,CAWS,UAACC,CAAD,EAAO;QACZH,cAAc,CAAC;UACbC,OAAO,EAAE;QADI,CAAD,CAAd;MAGD,CAfH;IAgBD,CApBH,EAqBGC,KArBH,CAqBS,UAACE,KAAD;MAAA,OACLJ,cAAc,CAAC;QACbC,OAAO,EAAEG,KAAK,CAACH;MADF,CAAD,CADT;IAAA,CArBT;EA0BD,CA3BD;;EA6BA,IAAMhB,YAAY,GAAG,SAAfA,YAAe,CAACH,IAAD,EAAoB;IACvC,IAAIA,IAAI,CAACuB,QAAL,IAAiBlE,aAAa,CAACmE,QAAd,CAAuBxB,IAAvB,CAArB,EAAmD;MACjD,IAAMyB,KAAK,GAAGpE,aAAa,CAACqE,OAAd,CAAsB1B,IAAtB,CAAd;;MACA,IAAIyB,KAAK,GAAG,CAAC,CAAb,EAAgB;QACdpE,aAAa,CAACsE,MAAd,CAAqBF,KAArB,EAA4B,CAA5B;MACD;IACF,CALD,MAKO,IAAI,CAACzB,IAAI,CAACuB,QAAN,IAAkB,CAAClE,aAAa,CAACmE,QAAd,CAAuBxB,IAAvB,CAAvB,EAAqD;MAC1D1C,gBAAgB,CAAC,UAACgC,IAAD;QAAA,kDAAcA,IAAd,IAAoBU,IAApB;MAAA,CAAD,CAAhB;IACD;;IACD5C,QAAQ,CACND,KAAK,CAACyE,GAAN,CAAU,UAACC,CAAD,EAAO;MACf,IAAI7B,IAAI,KAAK6B,CAAb,EAAgB;QACdA,CAAC,CAACN,QAAF,GAAa,CAACM,CAAC,CAACN,QAAhB;MACD;;MACD,OAAOM,CAAP;IACD,CALD,CADM,CAAR;EAQD,CAjBD;;EAmBA,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,GAAM;IAC5B,IAAI,CAAC/C,WAAL,EAAkB;MAChB3B,QAAQ,CACND,KAAK,CAACyE,GAAN,CAAU,UAAC5B,IAAD,EAAU;QAClBA,IAAI,CAACuB,QAAL,GAAgB,IAAhB;QACA,OAAOvB,IAAP;MACD,CAHD,CADM,CAAR;MAMA1C,gBAAgB,CAACH,KAAD,CAAhB;IACD,CARD,MAQO;MACLC,QAAQ,CACND,KAAK,CAACyE,GAAN,CAAU,UAAC5B,IAAD,EAAU;QAClBA,IAAI,CAACuB,QAAL,GAAgB,KAAhB;QACA,OAAOvB,IAAP;MACD,CAHD,CADM,CAAR;MAMA1C,gBAAgB,CAAC,EAAD,CAAhB;IACD;EACF,CAlBD;;EAoBA,IAAM2B,QAAQ;IAAA,4CAAG,aAAY;MAC3BxC,UAAU,CAACsF,kBAAX,CAA8BhF,UAAU,GAAG,UAA3C,EACG0D,IADH,CACQ,UAACuB,QAAD,EAAc;QAAA;;QAClB,IAAIjF,UAAU,MAAKhB,KAAL,sCAAKA,KAAK,CAAEa,MAAZ,qBAAK,eAAeC,OAApB,CAAd,EAA2C;UACzC,IAAMoF,aAAa,GAAGD,QAAQ,CAACE,MAAT,CACpB,UAACC,IAAD;YAAA,OAAUA,IAAI,KAAK,sBAAnB;UAAA,CADoB,CAAtB;UAGA,IAAMC,UAAU,GAAGH,aAAa,CAACL,GAAd,CAAkB,UAACS,QAAD;YAAA,OACnC5F,UAAU,CAAC6F,YAAX,CAAwBvF,UAAU,GAAG,UAAb,GAA0BsF,QAAlD,CADmC;UAAA,CAAlB,CAAnB;UAGAE,OAAO,CAACC,GAAR,CAAYJ,UAAZ,EAAwB3B,IAAxB,CAA6B,UAACgC,OAAD,EAAa;YACxC,IAAIC,SAAqB,GAAGD,OAAO,CAACb,GAAR,CAAY,UAACO,IAAD,EAAU;cAChD,IAAMQ,IAAI,GAAGR,IAAI,CAACS,GAAL,CAASrD,QAAT,CAAkB,GAAlB,IACT4C,IAAI,CAACS,GAAL,CACGC,KADH,CACS,CADT,EACYV,IAAI,CAACS,GAAL,CAASE,MAAT,GAAkB,CAD9B,EAEGC,KAFH,CAES,GAFT,EAGGC,GAHH,EADS,GAKTb,IAAI,CAACS,GAAL,CAASG,KAAT,CAAe,GAAf,EAAoBC,GAApB,EALJ;cAMA,OAAOC,MAAM,mBACRd,IADQ;gBAEXQ,IAAI,EAAJA,IAFW;gBAGXpB,QAAQ,EAAE;cAHC,GAAb;YAKD,CAZ2B,CAA5B;YAaAnE,QAAQ,CAACsF,SAAD,CAAR;YACA,IAAMQ,cAAc,GAAGT,OAAO,CAACP,MAAR,CAAe,UAACC,IAAD,EAAU;cAC9C,IAAIgB,aAAa,GAAGhB,IAAI,CAACS,GAAL,CACjBG,KADiB,CACX,GADW,EAEjBC,GAFiB,GAGjBD,KAHiB,CAGX,GAHW,EAIjBC,GAJiB,GAKjBI,WALiB,EAApB;;cAMA,IAAIC,uBAAA,CAAa7B,QAAb,CAAsB2B,aAAtB,CAAJ,EAA0C;gBACxC,OAAOhB,IAAP;cACD;YACF,CAVsB,CAAvB;YAWAnG,QAAQ,CAAC,IAAAsH,sBAAA,EAAUJ,cAAV,CAAD,CAAR;UACD,CA3BD;QA4BD;MACF,CAtCH,EAuCG9B,KAvCH,CAuCS,UAACC,CAAD,EAAO,CAAE,CAvClB;IAwCD,CAzCa;;IAAA,gBAARpC,QAAQ;MAAA;IAAA;EAAA,GAAd;;EAnJ4C,SA8L7BsE,eA9L6B;IAAA;EAAA;;EAAA;IAAA,mDA8L5C,WAA+BZ,IAA/B,EAA6C;MAC3C,IAAI;QACF,MAAMlG,UAAU,CAAC+G,kBAAX,CAA8BzG,UAAU,GAAG,UAAb,GAA0B4F,IAAxD,CAAN;QACA1D,QAAQ;QACRzB,sBAAsB,CAAC,KAAD,CAAtB;MACD,CAJD,CAIE,OAAO8D,KAAP,EAAc;QACdJ,cAAc,CAAC;UACbC,OAAO,EAAE;QADI,CAAD,CAAd;MAGD;IACF,CAxM2C;IAAA;EAAA;;EA0M5C,IAAMsC,SAAS;IAAA,4CAAG,aAAY;MAC5B,gCAAC,aAAY;QACX,IAAIC,qBAAA,CAASC,EAAT,KAAgB,KAApB,EAA2B;UACzB,kCACQC,WAAW,CAACC,mCAAZ,EADR;UAAA,IAAQC,MAAR,yBAAQA,MAAR;;UAEA,IAAIA,MAAM,KAAK,SAAf,EAA0B;YACxB5C,cAAc,CAAC;cACbC,OAAO,EACL;YAFW,CAAD,CAAd;UAID;;UACD4C,YAAY,CAACC,uBAAb;QACD;MACF,CAZD;MAcA,IAAMC,MAAM,SAASL,WAAW,CAACM,uBAAZ,CAAoC;QACvDC,UAAU,EAAEP,WAAW,CAACQ,gBAAZ,CAA6BC,GADc;QAEvDC,MAAM,EAAE,CAAC,CAAD,EAAI,CAAJ,CAF+C;QAGvDC,OAAO,EAAE;MAH8C,CAApC,CAArB;;MAMA,IAAI,CAACN,MAAM,CAACO,SAAZ,EAAuB;QACrB,YAAsBP,MAAtB;QAAA,IAAQrB,GAAR,SAAQA,GAAR;QAAA,IAAa6B,IAAb,SAAaA,IAAb;QACA,IAAMC,QAAgB,GAAG9B,GAAG,CAAC+B,OAAJ,CAAY,WAAZ,EAAyB,EAAzB,CAAzB;;QACA,IAAMC,GAAkB,GAAGC,gBAAA,CAAMC,IAAN,CAAWJ,QAAX,EAAsB,CAAtB,CAA3B;;QACA,IAAMK,cAAc,GAAGN,IAAI,KAAK,OAAT,GAAmB,MAAnB,GAA4B,MAAnD;QAEA,IAAMO,UAAU,GAAGjI,UAAU,GAAG,UAAhC;QACA,IAAMkI,WAAW,GACfD,UAAU,IACTA,UAAU,CAACzF,QAAX,CAAoB,UAApB,IAAkC,EAAlC,GAAuC,UAD9B,CAAV,GAEAwF,cAFA,GAGA,IAAA/D,eAAA,IAASC,MAAT,CAAgB,YAAhB,CAHA,GAIA,GAJA,GAKA2D,GANF;;QAQA,IAAI;UACF,MAAMrB,eAAe,CAAC,EAAD,CAArB;UACA,MAAM9G,UAAU,CAACyI,SAAX,CAAqB;YACzBC,IAAI,EAAEvC,GADmB;YAEzBwC,EAAE,EAAEH;UAFqB,CAArB,CAAN;UAIAhG,QAAQ;QACT,CAPD,CAOE,OAAOoG,GAAP,EAAY;UACZC,OAAO,CAAChE,KAAR,CAAc,sBAAd,EAAsC+D,GAAtC;QACD;MACF;IACF,CA/Cc;;IAAA,gBAAT5B,SAAS;MAAA;IAAA;EAAA,GAAf;;EA1M4C,SA4P7B8B,UA5P6B;IAAA;EAAA;;EAAA;IAAA,8CA4P5C,WACEJ,IADF,EAEEC,EAFF,EAGEI,cAHF,EAIEC,YAJF,EAKiB;MACfhJ,UAAU,CAACiJ,SAAX,CAAqB;QAAEP,IAAI,EAAJA,IAAF;QAAQC,EAAE,EAAFA;MAAR,CAArB,EACG3E,IADH,CACQ,YAAM;QACVxB,QAAQ;QACRiC,cAAc,CAAC;UACbC,OAAO,EAAEqE;QADI,CAAD,CAAd;MAGD,CANH,EAOGpE,KAPH,CAOS;QAAA,OACLF,cAAc,CAAC;UACbC,OAAO,EAAEsE;QADI,CAAD,CADT;MAAA,CAPT;IAYD,CA9Q2C;IAAA;EAAA;;EAgR5C,IAAME,YAAY;IAAA,4CAAG,aAAY;MAC/B,IAAM1B,MAAM,SAAS2B,cAAc,CAACC,gBAAf,CAAgC;QACnDC,oBAAoB,EAAE;MAD6B,CAAhC,CAArB;;MAIA,IAAI7B,MAAM,CAACQ,IAAP,KAAgB,SAApB,EAA+B;QAC7B,kCAAqChI,UAAU,CAAC6F,YAAX,CACnCvF,UAAU,GAAG,GAAb,GAAmBkH,MAAM,CAACtB,IADS,CAArC;QAAA,IAAgBoD,UAAhB,yBAAQC,MAAR;;QAGA,IAAID,UAAJ,EAAgB;UACdE,kBAAA,CAAMC,KAAN,CACE,kBADF,4DAE0DjC,MAAM,CAACtB,IAFjE,EAGE,CACE;YACEwD,IAAI,EAAE,QADR;YAEEC,KAAK,EAAE;UAFT,CADF,EAKE;YACED,IAAI,EAAE,kBADR;YAEEE,OAAO,EAAE,mBAAM;cACbd,UAAU,CACRtB,MAAM,CAACrB,GADC,EAER7F,UAAU,GAAG,GAAb,GAAmBkH,MAAM,CAACtB,IAFlB,EAGLsB,MAAM,CAACtB,IAHF,4BAIR,yCAJQ,CAAV;YAMD,CATH;YAUEyD,KAAK,EAAE;UAVT,CALF,CAHF;QAsBD,CAvBD,MAuBO;UACLb,UAAU,CACRtB,MAAM,CAACrB,GADC,EAER7F,UAAU,GAAG,GAAb,GAAmBkH,MAAM,CAACtB,IAFlB,EAGLsB,MAAM,CAACtB,IAHF,4BAIR,yCAJQ,CAAV;QAMD;MACF;IACF,CAzCiB;;IAAA,gBAAZgD,YAAY;MAAA;IAAA;EAAA,GAAlB;;EA2CA,IAAMW,mBAAmB;IAAA,4CAAG,WAAOC,IAAP,EAAiC;MAC3D,IAAMC,gBAAgB,GAAGD,IAAI,CAAC3E,GAAL,CAAS,UAACO,IAAD;QAAA,OAChC1F,UAAU,CAACiJ,SAAX,CAAqB;UACnBP,IAAI,EAAEhD,IAAI,CAACS,GADQ;UAEnBwC,EAAE,EAAErI,UAAU,GAAG,UAAb,GAA0BoF,IAAI,CAACuC;QAFhB,CAArB,CADgC;MAAA,CAAT,CAAzB;MAMAnC,OAAO,CAACC,GAAR,CAAYgE,gBAAZ,EAA8B/F,IAA9B,CAAmC,YAAM;QACvCrC,oBAAoB,CAAC,KAAD,CAApB;QACAa,QAAQ;MACT,CAHD;IAID,CAXwB;;IAAA,gBAAnBqH,mBAAmB;MAAA;IAAA;EAAA,GAAzB;;EAaA,IAAMG,iBAAiB;IAAA,4CAAG,WAAOC,WAAP,EAA+B;MACvD,IAAMrJ,aAAa,GAAGF,KAAK,CAAC+E,MAAN,CAAa,UAACC,IAAD;QAAA,OAAUA,IAAI,CAACZ,QAAf;MAAA,CAAb,CAAtB;MACA,IAAMoF,sBAAsB,SAASlK,UAAU,CAACsF,kBAAX,CACnC2E,WADmC,CAArC;;MAGA,SAASE,eAAT,GAA2B;QACzB,IAAMJ,gBAAgB,GAAGnJ,aAAa,CAACuE,GAAd,CAAkB,UAACO,IAAD,EAAU;UACnD,IAAIxD,UAAU,KAAK,MAAnB,EACE,OAAOlC,UAAU,CAACiJ,SAAX,CAAqB;YAC1BP,IAAI,EAAEpI,UAAU,GAAG,UAAb,GAA0BoF,IAAI,CAACQ,IADX;YAE1ByC,EAAE,EAAEsB,WAAW,GAAG,UAAd,GAA2BvE,IAAI,CAACQ;UAFV,CAArB,CAAP,CADF,KAME,OAAOlG,UAAU,CAACyI,SAAX,CAAqB;YAC1BC,IAAI,EAAEpI,UAAU,GAAG,UAAb,GAA0BoF,IAAI,CAACQ,IADX;YAE1ByC,EAAE,EAAEsB,WAAW,GAAG,UAAd,GAA2BvE,IAAI,CAACQ;UAFV,CAArB,CAAP;QAIH,CAXwB,CAAzB;QAYA,IAAAkE,wBAAA,EAAYL,gBAAZ,EAA8B,UAACM,CAAD,EAAO,CAAE,CAAvC,EAAyCrG,IAAzC,CAA8C,UAACY,CAAD,EAAO;UACnD7C,2BAA2B,CAAC,KAAD,CAA3B;UACAtB,UAAU,CAAC,EAAD,CAAV;UACA0B,aAAa,CAAC,EAAD,CAAb;UACAK,QAAQ;QACT,CALD;MAMD;;MACD,IAAM8H,gBAAgB,GAAG1J,aAAa,CAAC6E,MAAd,CAAqB,UAACC,IAAD;QAAA,OAC5CwE,sBAAsB,CAACnF,QAAvB,CAAgCW,IAAI,CAACQ,IAArC,CAD4C;MAAA,CAArB,CAAzB;MAGA,IAAMqE,OAAO,GAAGD,gBAAgB,CAACjE,MAAjC;;MACA,IAAIkE,OAAO,GAAG,CAAd,EAAiB;QACff,kBAAA,CAAMC,KAAN,CACE,mBADF,kCAEgCc,OAFhC,UAGIA,OAAO,KAAK,CAAZ,GAAgB,MAAhB,GAAyB,OAH7B,yBAIoBA,OAAO,KAAK,CAAZ,GAAgB,MAAhB,GAAyB,OAJ7C,SAKE,CACE;UACEb,IAAI,EAAE,QADR;UAEEC,KAAK,EAAE;QAFT,CADF,EAKE;UACED,IAAI,EAAE,mBADR;UAEEE,OAAO,EAAE,mBAAM;YACbO,eAAe;UAChB,CAJH;UAKER,KAAK,EAAE;QALT,CALF,CALF;MAmBD,CApBD,MAoBO;QACLQ,eAAe;MAChB;IACF,CApDsB;;IAAA,gBAAjBH,iBAAiB;MAAA;IAAA;EAAA,GAAvB;;EAsDA,IAAMrG,mBAAmB;IAAA,6CAAG,WAAO+B,IAAP,EAA2B;MACrD,IAAM8E,gBAAgB,GAAG9E,IAAI,GAAG,CAACA,IAAD,CAAH,GAAY9E,aAAzC;MACA,IAAM6J,WAAW,GAAGD,gBAAgB,CAACrF,GAAjB,CAAqB,UAACO,IAAD;QAAA,OACvC1F,UAAU,CAAC0K,WAAX,CAAuBhF,IAAI,CAACS,GAA5B,CADuC;MAAA,CAArB,CAApB;MAGAL,OAAO,CAACC,GAAR,CAAY0E,WAAZ,EACGzG,IADH,CACQ,UAACY,CAAD,EAAO;QACXH,cAAc,CAAC;UACbC,OAAO,EAAE;QADI,CAAD,CAAd;QAGAlC,QAAQ;QACR3B,gBAAgB,CAAC,EAAD,CAAhB;MACD,CAPH,EAQG8D,KARH,CAQS,UAACiE,GAAD,EAAS;QACdC,OAAO,CAAC8B,GAAR,CAAY/B,GAAZ;QACApG,QAAQ;MACT,CAXH;IAYD,CAjBwB;;IAAA,gBAAnBmB,mBAAmB;MAAA;IAAA;EAAA,GAAzB;;EAmBA,kBAAwD,IAAAzD,eAAA,EAAS,KAAT,CAAxD;EAAA;EAAA,IAAO0K,oBAAP;EAAA,IAA6BC,uBAA7B;;EAEA,IAAAtI,gBAAA,EAAU,YAAM;IACd,IAAIrB,mBAAmB,IAAI+F,qBAAA,CAASC,EAAT,KAAgB,SAA3C,EAAsD;MACpD4D,UAAU,CAAC,YAAM;QAAA;;QACf,yBAAAtJ,cAAc,CAACuJ,OAAf,2CAAwBC,KAAxB;MACD,CAFS,EAEP,GAFO,CAAV;IAGD;;IACD,IAAI,CAAC9J,mBAAL,EACE4J,UAAU,CAAC,YAAM;MACfD,uBAAuB,CAAC,KAAD,CAAvB;IACD,CAFS,EAEP,GAFO,CAAV;EAGH,CAVD,EAUG,CAAC3J,mBAAD,CAVH;;EAYA,IAAM+J,QAAQ;IAAA,6CAAG,aAAY;MAC3B,IAAMC,aAAa,GAAG5J,YAAY,CAAC6E,GAAb,CAAiBG,KAAjB,CAAuB,UAAvB,CAAtB;MACA,IAAM6E,cAAc,GAAGD,aAAa,CACjC9E,KADoB,CACd,CADc,EACX8E,aAAa,CAAC7E,MAAd,GAAuB,CADZ,EAEpB+E,IAFoB,CAEf,UAFe,CAAvB;MAGApL,UAAU,CAAC6F,YAAX,CAAwBsF,cAAc,GAAG,UAAjB,GAA8B/J,WAAtD,EAAmE4C,IAAnE,CAAwE,UAACC,GAAD,EAAS;QAC/E,IAAIA,GAAG,CAACsF,MAAR,EACE9E,cAAc,CAAC;UACbC,OAAO,EAAE;QADI,CAAD,CAAd,CADF,KAKE1E,UAAU,CAACyI,SAAX,CAAqB;UACnBC,IAAI,EAAEpH,YAAY,CAAC6E,GADA;UAEnBwC,EAAE,EAAEwC,cAAc,GAAG,GAAjB,GAAuB/J;QAFR,CAArB,EAIG4C,IAJH,CAIQ,YAAM;UACV7C,sBAAsB,CAAC,KAAD,CAAtB;UACAqB,QAAQ;QACT,CAPH,EAQGmC,KARH,CAQS,UAACC,CAAD;UAAA,OACLH,cAAc,CAAC;YACbC,OAAO,EAAE;UADI,CAAD,CADT;QAAA,CART;MAaH,CAnBD;IAoBD,CAzBa;;IAAA,gBAARuG,QAAQ;MAAA;IAAA;EAAA,GAAd;;EA2BA,IAAMxG,cAAc,GAAG,SAAjBA,cAAiB,CAACqF,IAAD,EAA8B;IACnDvK,QAAQ,CAAC,IAAA8L,uBAAA,EAASvB,IAAT,CAAD,CAAR;EACD,CAFD;;EAIA,OACE,sBAAC,iBAAD;IAAM,KAAK,EAAEtG,MAAM,CAAC8H,SAApB;IAAA,WACE,qBAAC,oBAAD;MACE,KAAK,EAAE,gBADT;MAEE,kBAAkB,EAAEjL,SAFtB;MAGE,OAAO,EAAE2B,kBAHX;MAIE,WAAW,EAAE,CACX,aADW,EAEX,oBAFW,EAGX,0BAHW,EAIX,UAJW,EAKX,QALW,CAJf;MAWE,SAAS,EAAE,CACT,QADS,EAET,OAFS,EAGT,yBAHS,EAIT,eAJS,EAKT,OALS,CAXb;MAkBE,OAAO,EAAEC,qBAlBX;MAmBE,aAAa,EAAE,uBAACsJ,WAAD,EAAiB;QAC9B,IAAIA,WAAW,KAAK,CAApB,EAAuB;UACrBvE,SAAS;QACV,CAFD,MAEO,IAAIuE,WAAW,KAAK,CAApB,EAAuB;UAC5B5J,oBAAoB,CAAC,IAAD,CAApB;QACD,CAFM,MAEA,IAAI4J,WAAW,KAAK,CAApB,EAAuB;UAC5BrC,YAAY;QACb,CAFM,MAEA,IAAIqC,WAAW,KAAK,CAApB,EAAuB;UAC5BtK,wBAAwB,CAAC,IAAD,CAAxB;QACD;MACF,CA7BH;MA8BE,iBAAiB,EAAE,CA9BrB;MA+BE,UAAU,EAAE;QAAEuK,eAAe,EAAE1L,MAAM,CAAC2L;MAA1B,CA/Bd;MAgCE,aAAa,EAAE;QAAEC,KAAK,EAAE5L,MAAM,CAAC4J;MAAhB,CAhCjB;MAiCE,UAAU,EAAE;QAAEgC,KAAK,EAAE5L,MAAM,CAAC6L;MAAhB;IAjCd,EADF,EAoCE,qBAAC,sCAAD;MACE,SAAS,EAAE7J,wBADb;MAEE,YAAY,EAAEC,2BAFhB;MAGE,UAAU,EAAEhC,MAHd;MAIE,OAAO,EAAES,OAJX;MAKE,UAAU,EAAEC,UALd;MAME,iBAAiB,EAAEuJ,iBANrB;MAOE,UAAU,EAAE9H,UAPd;MAQE,aAAa,EAAEC;IARjB,EApCF,EA8CE,qBAAC,gCAAD;MACE,OAAO,EAAErB,mBADX;MAEE,eAAe,EAAEgG,eAFnB;MAGE,sBAAsB,EAAE/F;IAH1B,EA9CF,EAmDE,sBAAC,0BAAD,CAAQ,SAAR;MAAkB,OAAO,EAAEG,mBAA3B;MAAA,WACE,qBAAC,0BAAD,CAAQ,KAAR;QAAc,KAAK,EAAE;UAAEwK,KAAK,EAAE;QAAT,CAArB;QAAA;MAAA,EADF,EAEE,qBAAC,0BAAD,CAAQ,KAAR;QACE,YAAY,EAAElK,cADhB;QAEE,KAAK,EAAEoK,SAAS,CAACxK,WAAD,CAFlB;QAGE,YAAY,EAAE,sBAACsI,IAAD,EAAU;UACtBrI,cAAc,CAACqI,IAAD,CAAd;QACD,CALH;QAME,UAAU,EAAE,sBAAM;UAChBmB,uBAAuB,CAAC,IAAD,CAAvB;QACD,CARH;QASE,SAAS,EACP,CAACD,oBAAD,GACI;UAAEiB,KAAK,EAAE,CAAT;UAAYC,GAAG,EAAEF,SAAS,CAACxK,WAAD,CAAT,CAAuBkF,KAAvB,CAA6B,GAA7B,EAAkC,CAAlC,EAAqCD;QAAtD,CADJ,GAEIhG,SAZR;QAcE,KAAK,EAAE;UAAEqL,KAAK,EAAE;QAAT;MAdT,EAFF,EAkBE,qBAAC,0BAAD,CAAQ,MAAR;QACE,KAAK,EAAC,QADR;QAEE,OAAO,EAAE,mBAAM;UACbvK,sBAAsB,CAAC,KAAD,CAAtB;QACD;MAJH,EAlBF,EAwBE,qBAAC,0BAAD,CAAQ,MAAR;QAAe,KAAK,EAAC,QAArB;QAA8B,OAAO,EAAE;UAAA,OAAM8J,QAAQ,EAAd;QAAA;MAAvC,EAxBF;IAAA,EAnDF,EA6EE,qBAAC,gCAAD;MACE,WAAW,EAAE;QACXO,eAAe,EAAE1L,MAAM,CAAC2L;MADb,CADf;MAIE,aAAa,EAAC,OAJhB;MAKE,YAAY,EAAEjI,MAAM,CAACuI,YALvB;MAME,YAAY,EAAEvI,MAAM,CAACwI,YANvB;MAOE,OAAO,EAAEtK,iBAPX;MAQE,cAAc,EAAE;QAAA,OAAMC,oBAAoB,CAAC,KAAD,CAA1B;MAAA,CARlB;MAAA,UAUE,qBAAC,mBAAD;QACE,mBAAmB,EAAEkI,mBADvB;QAEE,OAAO,EAAE;UAAA,OAAMlI,oBAAoB,CAAC,KAAD,CAA1B;QAAA;MAFX;IAVF,EA7EF,EA6FE,qBAAC,wCAAD;MACE,OAAO,EAAEC,qBADX;MAEE,KAAK,EAAC,kBAFR;MAGE,OAAO,EAAC;IAHV,EA7FF,EAmGE,sBAAC,iBAAD;MAAM,KAAK,EAAE4B,MAAM,CAACyI,UAApB;MAAA,WACE,sBAAC,iBAAD;QAAM,KAAK,EAAEzI,MAAM,CAAC0I,OAApB;QAAA,WACE,qBAAC,6BAAD;UAAkB,OAAO,EAAE;YAAA,OAAMjK,qBAAqB,CAAC,IAAD,CAA3B;UAAA,CAA3B;UAAA,UACE,qBAAC,sBAAD;YAAW,IAAI,EAAC,SAAhB;YAA0B,IAAI,EAAE,EAAhC;YAAoC,KAAK,EAAEnC,MAAM,CAACqM;UAAlD;QADF,EADF,EAIE,qBAAC,6BAAD;UAAkB,OAAO,EAAE;YAAA,OAAMpL,sBAAsB,CAAC,IAAD,CAA5B;UAAA,CAA3B;UAAA,UACE,qBAAC,oBAAD;YAAS,IAAI,EAAC,aAAd;YAA4B,IAAI,EAAE,EAAlC;YAAsC,KAAK,EAAEjB,MAAM,CAACqM;UAApD;QADF,EAJF;MAAA,EADF,EASG9J,WAAW,IACV,sBAAC,iBAAD;QAAM,KAAK,EAAEmB,MAAM,CAAC4I,QAApB;QAAA,WACE,qBAAC,6BAAD;UACE,OAAO,EAAE,mBAAM;YACbrK,2BAA2B,CAAC,IAAD,CAA3B;YACAI,aAAa,CAAC,MAAD,CAAb;UACD,CAJH;UAAA,UAME,qBAAC,mCAAD;YACE,IAAI,EAAC,mBADP;YAEE,IAAI,EAAE,EAFR;YAGE,KAAK,EAAErC,MAAM,CAACuM;UAHhB;QANF,EADF,EAcE,qBAAC,6BAAD;UAAkB,OAAO,EAAEhH,eAA3B;UAAA,UACE,qBAAC,oBAAD;YACE,KAAK,EAAE;cAAEiH,UAAU,EAAE;YAAd,CADT;YAEE,IAAI,EAAEhK,WAAW,GAAG,cAAH,GAAoB,QAFvC;YAGE,IAAI,EAAE,EAHR;YAIE,KAAK,EAAExC,MAAM,CAACqM;UAJhB;QADF,EAdF;MAAA,EAVJ;IAAA,EAnGF,EAsIE,qBAAC,iBAAD;MAAM,KAAK,oBAAO3I,MAAM,CAAC+I,QAAd;QAAwBC,cAAc,EAAE1M,MAAM,CAACqM;MAA/C,EAAX;MAAA,UACA,qBAAC,qBAAD;QACE,IAAI,EAAEzL,KADR;QAEE,4BAA4B,EAAE,KAFhC;QAGE,UAAU,EAAE4C,UAHd;QAIE,YAAY,EAAEmJ,aAJhB;QAKE,UAAU,EAAE;MALd;IADA,EAtIF,EA+IGpK,WAAW,IACV,qBAAC,iBAAD;MACE,KAAK,oBAAOmB,MAAM,CAACkJ,UAAd;QAA0BlB,eAAe,EAAE1L,MAAM,CAACuM;MAAlD,EADP;MAAA,UAGE,qBAAC,6BAAD;QAAA,UACE,qBAAC,mCAAD;UACE,IAAI,EAAC,gBADP;UAEE,IAAI,EAAE,EAFR;UAGE,KAAK,EAAEvM,MAAM,CAACqM;QAHhB;MADF;IAHF,EAhJJ,EA4JE,qBAAC,gBAAD,KA5JF;EAAA,EADF;AAgKD,CA9lBD;;AAgmBA,IAAMM,aAAa,GAAG,SAAhBA,aAAgB,CAAClJ,IAAD;EAAA,OAAoBA,IAAI,CAAC2C,IAAzB;AAAA,CAAtB;;AAEA,IAAM1C,MAAM,GAAGmJ,uBAAA,CAAWC,MAAX,CAAkB;EAC/BtB,SAAS,EAAE;IACTuB,IAAI,EAAE,CADG;IAETC,KAAK,EAAEC,eAFE;IAGTC,UAAU,EAAEC,sBAAA,CAAUC;EAHb,CADoB;EAM/BjB,UAAU,EAAE;IACVkB,OAAO,EAAE,MADC;IAEVC,aAAa,EAAE,KAFL;IAGVC,cAAc,EAAE,eAHN;IAIVC,UAAU,EAAE,QAJF;IAKVC,SAAS,EAAE,EALD;IAMVC,gBAAgB,EAAE;EANR,CANmB;EAc/BtB,OAAO,EAAE;IACPiB,OAAO,EAAE,MADF;IAEPC,aAAa,EAAE,KAFR;IAGPC,cAAc,EAAE,eAHT;IAIPC,UAAU,EAAE,QAJL;IAKPR,KAAK,EAAE;EALA,CAdsB;EAqB/BV,QAAQ,EAAE;IACRU,KAAK,EAAE,KADC;IAERK,OAAO,EAAE,MAFD;IAGRC,aAAa,EAAE,KAHP;IAIRC,cAAc,EAAE,UAJR;IAKRC,UAAU,EAAE;EALJ,CArBqB;EA4B/Bf,QAAQ,EAAE;IACRM,IAAI,EAAE,CADE;IAERY,cAAc,EAAE,GAFR;IAGRF,SAAS,EAAE,EAHH;IAIRC,gBAAgB,EAAE;EAJV,CA5BqB;EAkC/Bd,UAAU,EAAE;IACVgB,MAAM,EAAE,EADE;IAEVP,OAAO,EAAE,MAFC;IAGVC,aAAa,EAAE,KAHL;IAIVC,cAAc,EAAE,cAJN;IAKVC,UAAU,EAAE;EALF,CAlCmB;EAyC/BvB,YAAY,EAAE;IACZe,KAAK,EAAEC,eADK;IAEZW,MAAM,EAAEC,iBAAA,GAAS,GAFL;IAGZC,OAAO,EAAE,CAHG;IAIZC,MAAM,EAAE;EAJI,CAzCiB;EA+C/B7B,YAAY,EAAE;IACZc,KAAK,EAAEC,eADK;IAEZa,OAAO,EAAE,CAFG;IAGZC,MAAM,EAAE;EAHI,CA/CiB;EAoD/BpK,MAAM,EAAE;IACNoJ,IAAI,EAAE,CADA;IAENO,aAAa,EAAE,QAFT;IAGNS,MAAM,EAAE;EAHF;AApDuB,CAAlB,CAAf;;eA2DexO,O"},"metadata":{},"sourceType":"script","externalDependencies":[]}